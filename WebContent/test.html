<!DOCTYPE html>
<html>
<head>
<style>
html, body, canvas{
	margin:0;
	padding:0;
}
</style>
</head>
<body>

<canvas id="canvas" style="border:1px solid #000000;">
Your browser does not support the HTML5 canvas tag.
</canvas>

<script type="text/javascript" src="js/stats.js"></script>
<script type="text/javascript" src="js/core.js"></script>
<script type="text/javascript" src="js/colors.js"></script>
<script type="text/javascript" src="js/engine.js"></script>
<script type="text/javascript" src="js/inputListener.js"></script>
<script type="text/javascript" src="js/world.js"></script>
<script type="text/javascript" src="js/items.js"></script>
<script type="text/javascript" src="js/ball.js"></script>
<script type="text/javascript" src="js/bar.js"></script>

<script type="text/javascript">
(function(g, undefined){


	var world = new g.World(800,600);
	var inputListener = new g.InputListener();
	var engine = new g.Engine(world, inputListener);
	//var i = g.utils.getRandomInt(0,1023);
	var start = 0;
	var end = 512;
	var bar = new g.items.Bar(start, end, 5, 775);
	bar.setColor('red');
	bar.setPos(10,10);
	world.addItem(bar);
	engine.render();

	var i = start;
	function addBall(){
		var size = g.utils.getRandomInt(5,30);
		var startX = g.utils.getRandomInt(10,790 - 2*size);
		var startY = g.utils.getRandomInt(30,590 - 2*size);
		var startVx = g.utils.getRandomInt(-10,10);
		var startVy = g.utils.getRandomInt(-10,10);
		var color = g.utils.findColor(i%256);
		var ball = new g.items.Ball(size);
		ball.setPos(startX,startY);
		ball.setSpeed(startVx,startVy);
		ball.setAccel(0,0.1);
		ball.setColor(color['hexString']);
		world.addItem(ball);
		bar.setValue(bar.getValue() + 1);
		if((100 * i / end) >= 70){
			bar.setColor('green');
		}
		if((100 * i / end) < 70){
			bar.setColor(g.utils.findColor(184)['hexString']);
		}
		if((100 * i / end) < 30){
			bar.setColor('red');
		}
		ball.preRender();
		engine.render();
		i++;
		if(i < end){
			window.setTimeout(addBall, 1);
		}else{
			bar.setToDelete(true);
			world.init();
			engine.start();
		}
	}

	addBall();

	/*
	var i = 0;
	function loop(){
		engine.update();
		engine.render();
		i++;
		if(i > 20){
			return;
		}
		window.setTimeout(loop , 1000);
	}

	window.setTimeout(loop , 1000);
		*/

})(window.gameJs);
</script>
</body>
</html>
